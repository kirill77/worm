Goal
- Implement cortex contractility and flows that drive PAR polarization using local interactions, matching early C. elegans zygote biology.

Current status (implementation snapshot)
- Already implemented (brief)
  - Cortex geometry and lifecycle via TensionSphere/BVH; update cadence in the cortex organelle.
  - Uniformly sampled cortex binding sites with per-site bound molecule pools.
  - Movement between grid cells and binding sites for declared bindable molecules.
  - Bindable molecules include the CORTEX key and PAR cortex complexes (PAR-1:CORTEX, PAR-2:CORTEX, PAR-3:CORTEX).
  - Complex formation and phosphorylation antagonism rules (PAR-3:PAR-6, PAR-6:PKC-3; PKC-3 phosphorylates PAR-1/2; PAR-1 phosphorylates PAR-3).
  - Initial PAR placement and basic sampling hooks for readouts.

- Needs to be implemented (detailed)
  - Biological fidelity decision
    - No seed/proxy cues. Posterior asymmetry is driven by astral microtubule (MT) plus-end contact and AIR-1 localization.
  - Molecule-driven surface fields (no abstract fields without molecules)
    - Use cortex-bound molecule densities to compute fields:
      - R(x) = [RHO-1-GTP:CORTEX] / ([RHO-1-GTP:CORTEX] + [RHO-1-GDP:CORTEX])
      - E(x) ∝ [ECT-2:CORTEX], G(x) ∝ [CHIN-1:CORTEX]
      - C(x) ∝ [NMY-2:CORTEX] (or ∝ R(x) initially)
      - v(x) = −k_flow · ∇C(x)
  - Cortex-bound pools and binding kinetics
    - Add protein:CORTEX complexes for RHO-1-GTP, RHO-1-GDP, ECT-2, CHIN-1, NMY-2.
    - Add binding/unbinding rules between cytosolic proteins and CORTEX (on/off rates), and include these in Cortex::m_bindableMolecules.
    - Keep cytosolic pools for supply; compute fields from cortex-bound pools only.
  - Astral microtubules and contact mapping (required)
    - Implement MT dynamic instability from the posterior centrosome; detect per-site cortex contact M_contact(x) using the cortex BVH.
    - Localize AIR-1 to centrosomes/MTs or derive contact-weighted inhibition directly from contacts.
    - At contacted sites: reduce ECT-2 effectiveness and/or increase CHIN-1; modestly boost PAR-2 on-rate.
  - Surface transport and mechanics
    - CortexSurfaceGrid with per-site arrays for R(x), E(x), G(x), C(x), v(x), and bound species; APIs: updateRho(), computeContractilityAndFlow(), advect(), diffuse(), react(), exchange().
    - 2D advection of bound species by v(x) and lateral diffusion across binding sites; CFL constraints for stability.
  - Orchestration in cortex update
    - Per time step: MTs/contact → updateRho (molecule-driven) → computeContractilityAndFlow → advect → diffuse → react → exchange → sync with Medium.
  - Parameters and validation
    - Add/tune parameters for GEF/GAP kinetics, contractility and flow, surface diffusion; extend DataCollector for bound PAR A/P ratios, M_contact coverage, mean |v|, and RHO-1 anterior/posterior.

Key biological stance (no secretion)
- AIR-1 (Aurora A) is a kinase enriched at centrosomes/astral microtubules; it is not secreted.
- The cortex “senses” nearby centrosome/MTs via local contact/proximity, which inhibits ECT-2 (RhoGEF) posteriorly → RHO-1↓ → contractility↓ → anterior cortical flows.

Mechanisms to capture (minimal viable set first)
- Cortex-local Rho module: ECT-2 (GEF) vs RhoGAP (CHIN-1 proxy) controls RHO-1 activity per cortex site
- Contractility C derived from local RHO-1 activity; flows from ∇C
- Lateral (2D) diffusion and advection of cortex-bound PARs
- Mutual antagonism of PAR complexes (present): PAR-6:PKC-3 vs PAR-1/PAR-2, evaluated locally
- MT-contact–dependent posterior reinforcement: boost PAR-2 binding and inhibit ECT-2 at contacted sites (phase 2)
- CDC-42 module to recruit/activate PAR-6:PKC-3 anteriorly; posterior inhibition (phase 3)

State variables
- Cortex surface (2D over boundary cells or dedicated mesh):
  - RHO-1 activity R(x) ∈ [0,1]
  - ECT-2 activity E(x) and effective GAP activity G(x) (simple scalars per site)
  - Contractility C(x) (dimensionless); Velocity v(x) tangential
  - Bound densities: PAR-3:CORTEX, PAR-2:CORTEX, PAR-1:CORTEX, PAR-6:PKC-3
  - Optional: CDC-42-GTP field A(x) (anterior high)
- Cytosol (3D):
  - Astral microtubules from the sperm centrosome; plus-end contact flags at cortex sites

Local drivers (strictly local)
- MT–cortex contact map M_contact(x): 1 if a plus-end contacts/nearby; else 0
- Posterior inhibition at contact sites (examples):
  - E_eff(x) = E_base · (1 − k_air1 · M_contact(x))
  - or G_eff(x) = G_base + k_gap · M_contact(x)
- Posterior reinforcement: increase PAR-2:CORTEX on-rate at contact sites

Dynamics
- Rho module at cortex (per surface site):
  - dR/dt = k_gef · E_eff(x) · (1 − R) − k_gap_eff · R, with k_gap_eff ∝ G_eff(x)
- Contractility and flows:
  - C(x) = k_c · R(x) (clamp to [Cmin, Cmax])
  - v(x) = −k_flow · ∇C(x) (flow from high to low contractility)
- Bound PARs (surface advection–diffusion–reaction):
  - ∂M/∂t = −∇·(M v) + D_s ∇²M + R_local(M; PKC-3, PAR-1, PAR-2)
  - Local rate modifiers from M_contact (e.g., PAR-2 binding up at contact sites)

Numerical scheme (explicit, stable)
- Cortex representation: reuse boundary cells (e.g., |y|≈0.9) as surface layer initially; later switch to a proper spherical surface grid
- Per time step:
  1) Update MTs from centrosome; compute M_contact(x) on cortex (required, no seed proxies)
  2) Update E_eff/G_eff from M_contact; integrate RHO-1 using molecule-driven kinetics
  3) Compute C and v = −k_flow ∇C on the surface
  4) Advect bound species (semi-Lagrangian or upwind)
  5) Diffuse bound species laterally (Laplacian stencil)
  6) Apply local reactions (phosphorylation/complexes) and cytosol↔surface binding/unbinding
- CFL constraints: max(|v|)·dt/Δs < 0.5; D_s·dt/Δs² < 0.25

Codebase integration points
- New: AstralMTs module (growth/shrink; catastrophe/rescue; plus-end contact queries against cortex BVH)
- New: CortexSurfaceGrid (surface fields from cortex-bound molecules; API: updateRho(), computeContractilityAndFlow(), advect(), diffuse(), react(), exchange())
- Modify: Cortex.cpp to own/run the sequence and to register new bindable molecules
- Modify: Centrosome (spawn/manage MTs, AIR-1 enrichment)
- Keep GridDiffusion: unbound only; bound species move via surface mechanics
- Optional: CDC42Module (surface field A(x) regulating PAR-6:PKC-3)

Parameters (initial guesses; tune later)
- Rho module: k_gef, k_gap, E_base, G_base, k_air1, k_gap (contact), R ∈ [0,1]
- Contractility: k_c, Cmin, Cmax; Flow: k_flow
- Surface diffusion D_s per species (PAR-3 > PAR-2 typical)
- MTs: growth speed, catastrophe/rescue rates, max length, contact radius
- PAR-2 reinforcement factor at contact

Validation (DataCollector)
- PAR-3:CORTEX and PAR-2:CORTEX at y=±0.9; compute A/P ratios
- Fraction of cortex marked by M_contact; posterior domain size
- Optional: mean |v| (flow speed) and RHO-1 posterior vs anterior

Phased implementation
- Phase 1: Astral MTs and local contact coupling (biologically faithful, no seeds)
  1) Implement AstralMTs and M_contact(x) on cortex via BVH hits; AIR-1 localization.
  2) Add cortex-bound pools and binding kinetics for RHO-1-GTP/GDP, ECT-2, CHIN-1, NMY-2; compute R(x), E(x), G(x) from bound densities; couple contacts to local rates.
- Phase 2: Contractility and surface transport
  3) Compute C(x) and v(x) from molecule-driven fields; add surface advection + diffusion for bound species; enforce CFL.
- Phase 3: CDC‑42/PKC‑3 anterior activation; tuning and validation
  4) Add CDC-42 module and couple to PAR-6:PKC-3 recruitment/activity; posterior inhibition.
  5) Tune parameters to literature A/P ratios, posterior domain size, flow speeds (6–10 min); expand DataCollector.

Notes
- All effects are local by construction (MT–cortex contacts, cortex-only Rho module)
- No secreted fields; AIR-1 acts via MT/centrosome proximity; contractility emerges from local RHO-1
